<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Main (legifrance_catala.Legifrance_catala.Main)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">legifrance_catala</a> &#x00BB; <a href="../index.html">Legifrance_catala</a> &#x00BB; Main</nav><h1>Module <code>Legifrance_catala.Main</code></h1></header><aside><p>Main logic for interacting with LegiFrance when traversing Catala source files</p></aside><dl><dt class="spec type" id="type-new_article_version"><a href="#type-new_article_version" class="anchor"></a><code><span class="keyword">type</span> new_article_version</code><code> = </code><table class="variant"><tr id="type-new_article_version.NotAvailable" class="anchored"><td class="def constructor"><a href="#type-new_article_version.NotAvailable" class="anchor"></a><code>| </code><code><span class="constructor">NotAvailable</span></code></td></tr><tr id="type-new_article_version.Available" class="anchored"><td class="def constructor"><a href="#type-new_article_version.Available" class="anchor"></a><code>| </code><code><span class="constructor">Available</span> <span class="keyword">of</span> string</code></td></tr></table></dt></dl><dl><dt class="spec value" id="val-check_article_expiration"><a href="#val-check_article_expiration" class="anchor"></a><code><span class="keyword">val</span> check_article_expiration : <a href="../../../catala/Catala/Ast/index.html#type-law_article">Catala.Ast.law_article</a> <span>&#45;&gt;</span> <a href="../Api/index.html#type-access_token">Api.access_token</a> <span>&#45;&gt;</span> <span><a href="index.html#type-new_article_version">new_article_version</a> option</span></code></dt><dd><p>Returns the ID of the future version of the article if any</p></dd></dl><dl><dt class="spec type" id="type-article_text_acc"><a href="#type-article_text_acc" class="anchor"></a><code><span class="keyword">type</span> article_text_acc</code><code> = </code><code>{</code><table class="record"><tr id="type-article_text_acc.article_title" class="anchored"><td class="def field"><a href="#type-article_text_acc.article_title" class="anchor"></a><code>article_title : <span>string <a href="../../../catala/Catala/Pos/index.html#type-marked">Catala.Pos.marked</a></span>;</code></td></tr><tr id="type-article_text_acc.text" class="anchored"><td class="def field"><a href="#type-article_text_acc.text" class="anchor"></a><code>text : string;</code></td></tr><tr id="type-article_text_acc.new_version" class="anchored"><td class="def field"><a href="#type-article_text_acc.new_version" class="anchor"></a><code>new_version : <span>string option</span>;</code></td></tr><tr id="type-article_text_acc.current_version" class="anchored"><td class="def field"><a href="#type-article_text_acc.current_version" class="anchor"></a><code>current_version : <span>string option</span>;</code></td></tr></table><code>}</code></dt><dd><p>Accumulator type when traversing the Catala source files</p></dd></dl><dl><dt class="spec module" id="module-Diff"><a href="#module-Diff" class="anchor"></a><code><span class="keyword">module</span> <a href="Diff/index.html">Diff</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Diff algorithm for a list of words</p></dd></dl><dl><dt class="spec value" id="val-compare_article_to_version"><a href="#val-compare_article_to_version" class="anchor"></a><code><span class="keyword">val</span> compare_article_to_version : <a href="../Api/index.html#type-access_token">Api.access_token</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><a href="Diff/index.html#type-t">Diff.t</a> option</span></code></dt><dd><p><code>compare_article_to_version token text version</code> retrieves the text of the article whose LegiFrance ID is <code>version</code> and produces a diff with the expected <code>text</code></p></dd></dl><dl><dt class="spec value" id="val-compare_to_versions"><a href="#val-compare_to_versions" class="anchor"></a><code><span class="keyword">val</span> compare_to_versions : <a href="index.html#type-article_text_acc">article_text_acc</a> <span>&#45;&gt;</span> <a href="../Api/index.html#type-access_token">Api.access_token</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Compares <code>article_text_acc.current_version</code> and <code>article_text_acc.new_version</code> by accessing LegiFrance and display differences if any</p></dd></dl><dl><dt class="spec value" id="val-include_legislative_text"><a href="#val-include_legislative_text" class="anchor"></a><code><span class="keyword">val</span> include_legislative_text : <span>string <a href="../../../catala/Catala/Pos/index.html#type-marked">Catala.Pos.marked</a></span> <span>&#45;&gt;</span> <a href="../Api/index.html#type-access_token">Api.access_token</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Fill an <code>@@Include ...@@</code> tag inside the Catala source file with the legislative contents retrieved from LegiFrance</p></dd></dl><dl><dt class="spec value" id="val-driver"><a href="#val-driver" class="anchor"></a><code><span class="keyword">val</span> driver : string <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Parses the Catala master source file and checks each article:</p><ul><li>if the article has a LegiFrance ID, checks the text of the article in the source code vs the text from LegiFrance;</li><li>if the article has an expiration date, display the difference between the current version of the article and the next one on LegiFrance;</li><li>fill each <code>@@Include ...@@</code> tag with the contents retrieved from LegiFrance</li></ul></dd></dl><dl><dt class="spec value" id="val-main"><a href="#val-main" class="anchor"></a><code><span class="keyword">val</span> main : unit <span>&#45;&gt;</span> unit</code></dt><dd><p>Hook for the executable</p></dd></dl></div></body></html>